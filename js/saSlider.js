(function(e){var f,a,d="saSlider",c={window:e(window),document:e(document)},g=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(h){return window.setTimeout(h,1000/60)},f={loop:true,indicators:true,keys:{prev:"37, 80",next:"39, 78"}};function b(i,h){this.slider=e(i);this.slides=this.slider.find("> ul > li");this.settings=e.extend({},f,h||{});this.active=this.slider.find(".active");this.index=0;if(!this.settings.loop){this.markEdges()}this.checkOrientation.call(this);this.bind()}b.prototype={bind:function(){var h=this;this.slider.on("click","> .arrow",this.events.btn.bind(this));this.slider.find("> ul").on("transitionend","> li",this.events.transitionEnd.bind(this));c.document.on("keydown."+d,this.events.keyDown.bind(this));if(this.settings.indicators){this.indicators.generate.apply(this);this.indicators.elm.on("click","i",function(){h.changeSlide(e(this).index())})}c.window.on("resize."+d,function(){Date.now()%2==0&&h.checkOrientation.call(h)});this.slider.on("dragstart",function(i){i.preventDefault()});this.slider.on("swipe",this.events.move.bind(this));this.slider.on("mouseup touchend",this.events.cancelDragging.bind(this))},events:{drag:{offset:0,dirtySlides:e(),dragSibling:null},btn:function(i){var h=i.currentTarget.classList[1]=="next"?this.index+1:this.index-1;this.changeSlide(h)},keyDown:function(i){var h=this.settings.keys.next.indexOf(i.keyCode)?this.index-1:this.index+1;return this.settings.keys.next.indexOf(i.keyCode)>=0&&this.changeSlide(h)||this.settings.keys.prev.indexOf(i.keyCode)>=0&&this.changeSlide(h)||true},transitionEnd:function(h){this.events.drag.dirtySlides=e();this.slides.each(function(){this.removeAttribute("style")})},move:function(m,j,i){var l=this,k=(j/this.slider[0].clientWidth)*100,h=j>0?this.index+1:this.index-1;this.events.drag.offset=k;k=Math.abs(k);if(h>this.slides.length-1){h=0}else{if(h<0){h=this.slides.length-1}}this.events.drag.dragSibling=this.slides.eq(h);this.events.drag.dirtySlides=this.events.drag.dirtySlides.add(this.events.drag.dragSibling[0]);l.slider.toggleClass("prevSlide",j>0);g(function(){l.slider.addClass("dragging");if(l.events.drag.dragSibling){l.events.drag.dragSibling[0].style.width=k+"%"}l.active[0].style.width=100-k+"%";l.events.drag.dirtySlides.not(l.events.drag.dragSibling).removeAttr("style")})},cancelDragging:function(i){var h=22;this.slider.removeClass("dragging");this.events.drag.dragSibling&&this.events.drag.dragSibling.removeClass("active").removeAttr("style");this.active.removeAttr("style");if(this.events.drag.offset<-h){this.changeSlide(this.index-1,true)}else{if(this.events.drag.offset>h){this.changeSlide(this.index+1,true)}}this.events.drag.offset=0;this.events.drag.dragSibling=null}},changeSlide:function(h,k){var j=this.active.width()<this.slider[0].clientWidth,l=this.slides.eq(h),i;if(!k&&j||(!this.settings.loop&&!l.length)){return}this.slider.toggleClass("prevSlide",h<this.index);if(h>this.slides.length-1){h=0}else{if(h<0){h=this.slides.length-1}}l=this.slides.eq(h);this.checkOrientation.call(this,l);this.active.css("width",0).removeClass("active");this.active=l.addClass("active");if(!this.settings.loop){this.markEdges()}this.index=h;if(this.settings.indicators){this.indicators.mark.apply(this)}},checkOrientation:(function(){var h;return function(n){n=n||this.active;var m=this,j,i,l,k;clearTimeout(h);h=setTimeout(function(){j=n.find("> img")[0];if(j.clientWidth==0||j.clientHeight==0){m.checkOrientation.call(m,n);return}i=j.naturalWidth/j.naturalHeight;l=m.slider[0].clientWidth/m.slider[0].clientHeight;k=i>l;n.toggleClass("portrait",k)},20)}})(),markEdges:function(){this.slider.toggleClass("start",!this.active.prev().length).toggleClass("end",!this.active.next().length)},indicators:{generate:function(){var h='<div class="indicators"><div class="wrap">'+Array(this.slides.length+1).join("<i></i>")+"<b></b></div></div>";this.slider.append(h);this.indicators.elm=this.slider.find(".indicators");this.indicators.marker=this.indicators.elm.find("b");return this},mark:function(){var h=this.indicators.marker.outerWidth(true)*this.index;this.indicators.marker.css("left",h);return this}}};e.fn[d]=function(h){return this.each(function(){var i=e(this).data("_"+d);if(i){return this}e(this).data("_"+d,new b(this,h))})}})(jQuery);
